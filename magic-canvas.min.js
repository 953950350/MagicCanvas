jQuery.magicCanvas={draw:function(a){function b(){s=document.getElementById("reactive-bg-canvas"),q=$(window).width(),r=$(window).height(),s.style.position="fixed",s.style.zIndex=-99999,s.style.top="0px",s.style.left="0px",s.width=q,s.height=r,v={x:q/2,y:r/2},t=s.getContext("2d"),n()}function c(){"ontouchstart"in window||window.addEventListener("mousemove",d),window.addEventListener("resize",e)}function d(a){v.x=a.pageX,v.y=a.pageY}function e(){q=window.innerWidth,r=window.innerHeight,s.width=q,s.height=r,b()}function f(){g(),setInterval(h,A.heartBeatCD)}function g(){t.clearRect(0,0,q,r);for(var a=0;a<x.length;a++){var b=x[a];b.circle.active>0&&(b.circle.active-=.012,b.circle.draw())}requestAnimationFrame(g)}function h(){var a=i(),b=new l(a,0),c=.8*A.heartBeatCD,d=60*c/1e3,e=A.heartBeatRange/d,f=c/d,g=.8,h=o();x=[];var j=function(){if(b.radius<A.heartBeatRange){for(var a=0;a<u.length;a++){var c=u[a];if(m(c,b.pos)<Math.pow(b.radius,2))for(var d=0;d<c.closest.length;d++){var i=c.closest[d],n=k(c,i,b);void 0!=n&&(n.circle=new l(n,1.2,h),n.circle.active=g,g*=.999,x.push(n))}}setTimeout(j,f),b.radius+=e}};w&&j()}function i(){for(var a={x:-100,y:-100},b=o(),c=0;c<u.length;c++){var d=u[c];a=m(b,d)<m(b,a)?d:a}return a}function j(a,b){var c=A.lineLen*Math.sin(60*Math.PI/180),d=A.lineLen*Math.cos(60*Math.PI/180),e={closest:[]};return"left"==b||"right"==b?(e.x=a.x+A.lineLen*("left"==b?-1:1),e.y=a.y):"rightTop"==b||"rightBottom"==b?(e.x=a.x+d,e.y=a.y+c*("rightTop"==b?-1:1)):("leftTop"==b||"leftBottom"==b)&&(e.x=a.x-d,e.y=a.y+c*("leftTop"==b?-1:1)),e.type=b,a.closest.push(e),e.closest.push(a),e}function k(a,b,c){var d=m(a,c.pos),e=m(b,c.pos),f=Math.sqrt(Math.max(d,e)),g=Math.sqrt(Math.min(d,e));if(g<c.radius&&f>c.radius){var h=(a.y-b.y)/(a.x-b.x),i=a.y-h*a.x,j=-c.pos.x,k=-c.pos.y,l=c.radius,n=(Math.pow(h,2)+1)*Math.pow(l,2)-Math.pow(j*h,2)+2*(j*k+i*j)*h-Math.pow(k+i,2),o=(-1*Math.sqrt(n)-h*(k+i)-j)/(Math.pow(h,2)+1),p=(Math.sqrt(n)-h*(k+i)-j)/(Math.pow(h,2)+1),q=o<Math.max(a.x,b.x)&&o>Math.min(a.x,b.x)?o:p,r=h*q+i;return{x:q,y:r}}}function l(a,b,c){this.pos=a||null,this.radius=b||null,this.centerP=c||a,this.draw=function(){if(this.active){t.beginPath(),t.arc(this.pos.x,this.pos.y,this.radius,0,2*Math.PI,!1);var b="function"==typeof A.rgb?A.rgb(a,c):A.rgb;b="".concat(b.r).concat(",").concat(b.g).concat(",").concat(b.b),t.fillStyle="rgba("+b+","+this.active+")",t.fill()}}}function m(a,b){return Math.pow(a.x-b.x,2)+Math.pow(a.y-b.y,2)}function n(){var a={x:q/2,y:r/2,closest:[]},b=[j(a,"left"),j(a,"rightTop"),j(a,"rightBottom")];for(u=[a];b.length>0;){var c=b.pop();if(0<c.x&&c.x<q&&0<c.y&&c.y<r){for(var d=!1,e=0;e<u.length;e++){var f=u[e],g=m(c,f);if(g<.1*Math.pow(A.lineLen,2)){d=!0;break}}if(!d){u.push(c);var h=c.type;"leftTop"==h||"leftBottom"==h?(b.unshift(j(c,"left")),b.unshift(j(c,"leftTop"==h?"rightTop":"rightBottom"))):"rightTop"==h||"rightBottom"==h?(b.unshift(j(c,"right")),b.unshift(j(c,"rightTop"==h?"leftTop":"leftBottom"))):"left"==h?(b.unshift(j(c,"leftBottom")),b.unshift(j(c,"leftTop"))):"right"==h&&(b.unshift(j(c,"rightBottom")),b.unshift(j(c,"rightTop")))}}}for(var e=0;e<u.length;e++)u[e].circle=new l(u[e],2)}function o(){var a=v.x-y.offset().left,b=v.y-y.offset().top;return{x:a,y:b}}function p(){for(var a=0,b=["ms","moz","webkit","o"],c=0;c<b.length&&!window.requestAnimationFrame;++c)window.requestAnimationFrame=window[b[c]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[b[c]+"CancelAnimationFrame"]||window[b[c]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(b,c){var d=(new Date).getTime(),e=Math.max(0,16-(d-a)),f=window.setTimeout(function(){b(d+e)},e);return a=d+e,f}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)})}p();var q,r,s,t,u,v,w=!0,x=[],y=$("#reactive-bg-canvas"),z={lineLen:30,heartBeatCD:3e3,heartBeatRange:300,rgb:{r:156,g:217,b:249}},A=$.extend(z,a);$(document).mouseenter(function(){w=!0}),$(document).mouseleave(function(){w=!1}),b(),f(),c()}};