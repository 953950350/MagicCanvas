jQuery.magicCanvas={reqId:0,draw:function(a){function m(){d=document.getElementById("reactive-bg-canvas"),b=$(window).width(),c=$(window).height(),d.style.position="fixed",d.style.zIndex=l.zIndex,d.style.top="0px",d.style.left="0px",d.width=b,d.height=c,g={x:b/2,y:c/2,rx:b/2,ry:c/2},e=d.getContext("2d"),B()}function n(){"ontouchstart"in window||window.addEventListener("mousemove",p),window.addEventListener("scroll",o),window.addEventListener("resize",q)}function o(){g.x=g.rx+document.body.scrollLeft+document.documentElement.scrollLeft,g.y=g.ry+document.body.scrollTop+document.documentElement.scrollTop}function p(a){a.pageX||a.pageY?(g.x=a.pageX,g.y=a.pageY):(a.clientX||a.clientY)&&(g.x=a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,g.y=a.clientY+document.body.scrollTop+document.documentElement.scrollTop),g.rx=a.clientX,g.ry=a.clientY}function q(){b=window.innerWidth,c=window.innerHeight,d.width=b,d.height=c,window.cancelAnimationFrame(),m(),r()}function r(){if(this.reqId&&D(this.reqId),s(),"heart-beat"==l.type)setInterval(t,l.heartBeatCD);else if("random-move"==l.type)for(var a=0;a<f.length;a++)u(f[a])}function s(){if(e.clearRect(0,0,b,c),"heart-beat"==l.type)for(var a=0;a<i.length;a++){var d=i[a];d.circle.active>0&&(d.circle.active-=.012,d.circle.draw())}else if("random-move"==l.type)for(var g=C(),a=0;a<f.length;a++)Math.abs(A(g,f[a]))<4e3?(f[a].active=.3,f[a].circle.active=.6):Math.abs(A(g,f[a]))<2e4?(f[a].active=.1,f[a].circle.active=.3):Math.abs(A(g,f[a]))<4e4?(f[a].active=.02,f[a].circle.active=.1):(f[a].active=0,f[a].circle.active=0),z(f[a]),f[a].circle.draw();this.reqId=requestAnimationFrame(s)}function t(){var a=v(),b=new y(a,0),c=.8*l.heartBeatCD,d=60*c/1e3,e=l.heartBeatRange/d,g=c/d,j=.8,k=C();i=[];var m=function(){if(b.radius<l.heartBeatRange){for(var a=0;a<f.length;a++){var c=f[a];if(A(c,b.pos)<Math.pow(b.radius,2))for(var d=0;d<c.closest.length;d++){var h=c.closest[d],n=x(c,h,b);void 0!=n&&(n.circle=new y(n,1.2,k),n.circle.active=j,j*=.999,i.push(n))}}setTimeout(m,g),b.radius+=e}};h&&m()}function u(a){TweenLite.to(a,1+Math.random(),{x:a.originX-50+100*Math.random(),y:a.originY-50+100*Math.random(),onComplete:function(){u(a)}})}function v(){for(var a={x:-100,y:-100},b=C(),c=0;c<f.length;c++){var d=f[c];a=A(b,d)<A(b,a)?d:a}return a}function w(a,b){var c=l.lineLen*Math.sin(60*Math.PI/180),d=l.lineLen*Math.cos(60*Math.PI/180),e={closest:[]};return"left"==b||"right"==b?(e.x=a.x+l.lineLen*("left"==b?-1:1),e.y=a.y):"rightTop"==b||"rightBottom"==b?(e.x=a.x+d,e.y=a.y+c*("rightTop"==b?-1:1)):("leftTop"==b||"leftBottom"==b)&&(e.x=a.x-d,e.y=a.y+c*("leftTop"==b?-1:1)),e.type=b,a.closest.push(e),e.closest.push(a),e}function x(a,b,c){var d=A(a,c.pos),e=A(b,c.pos),f=Math.sqrt(Math.max(d,e)),g=Math.sqrt(Math.min(d,e));if(g<c.radius&&f>c.radius){var h=(a.y-b.y)/(a.x-b.x),i=a.y-h*a.x,j=-c.pos.x,k=-c.pos.y,l=c.radius,m=(Math.pow(h,2)+1)*Math.pow(l,2)-Math.pow(j*h,2)+2*(j*k+i*j)*h-Math.pow(k+i,2),n=(-1*Math.sqrt(m)-h*(k+i)-j)/(Math.pow(h,2)+1),o=(Math.sqrt(m)-h*(k+i)-j)/(Math.pow(h,2)+1),p=n<Math.max(a.x,b.x)&&n>Math.min(a.x,b.x)?n:o,q=h*p+i;return{x:p,y:q}}return void 0}function y(a,b,c){this.pos=a||null,this.radius=b||null,this.centerP=c,this.draw=function(){if(this.active){e.beginPath(),e.arc(this.pos.x,this.pos.y,this.radius,0,2*Math.PI,!1);var a="function"==typeof l.rgb?l.rgb(this.pos,this.centerP||this.pos):l.rgb;a="".concat(a.r).concat(",").concat(a.g).concat(",").concat(a.b),e.fillStyle="rgba("+a+","+this.active+")",e.fill()}}}function z(a){if(a.active)for(var b=0;b<a.closest.length;b++){e.beginPath(),e.moveTo(a.x,a.y),e.lineTo(a.closest[b].x,a.closest[b].y);var c="function"==typeof l.rgb?l.rgb(g):l.rgb;c="".concat(c.r).concat(",").concat(c.g).concat(",").concat(c.b),e.strokeStyle="rgba("+c+","+a.active+")",e.stroke()}}function A(a,b){return Math.pow(a.x-b.x,2)+Math.pow(a.y-b.y,2)}function B(){if("random-move"==l.type){f=[];for(var a=0;b>a;a+=b/20)for(var d=0;c>d;d+=c/20){var e=a+Math.random()*b/20,g=d+Math.random()*c/20,h={x:e,originX:e,y:g,originY:g};f.push(h)}for(var i=0;i<f.length;i++){for(var j=[],k=f[i],m=0;m<f.length;m++){var n=f[m];if(k!=n){for(var o=!1,p=0;5>p;p++)o||void 0==j[p]&&(j[p]=n,o=!0);for(var p=0;5>p;p++)o||A(k,n)<A(k,j[p])&&(j[p]=n,o=!0)}}k.closest=j}for(var i=0;i<f.length;i++)f[i].circle=new y(f[i],2+2*Math.random(),void 0)}else if("heart-beat"==l.type){var q={x:b/2,y:c/2,closest:[]},r=[w(q,"left"),w(q,"rightTop"),w(q,"rightBottom")];for(f=[q];r.length>0;){var h=r.pop();if(0<h.x&&h.x<b&&0<h.y&&h.y<c){for(var s=!1,i=0;i<f.length;i++){var t=f[i],u=A(h,t);if(u<.1*Math.pow(l.lineLen,2)){s=!0;break}}if(!s){f.push(h);var v=h.type;"leftTop"==v||"leftBottom"==v?(r.unshift(w(h,"left")),r.unshift(w(h,"leftTop"==v?"rightTop":"rightBottom"))):"rightTop"==v||"rightBottom"==v?(r.unshift(w(h,"right")),r.unshift(w(h,"rightTop"==v?"leftTop":"leftBottom"))):"left"==v?(r.unshift(w(h,"leftBottom")),r.unshift(w(h,"leftTop"))):"right"==v&&(r.unshift(w(h,"rightBottom")),r.unshift(w(h,"rightTop")))}}}for(var i=0;i<f.length;i++)f[i].circle=new y(f[i],2)}}function C(){var a=g.x-j.offset().left,b=g.y-j.offset().top;return{x:a,y:b}}function D(a){for(var b=0,c=["ms","moz","webkit","o"],d=0;d<c.length&&!window.requestAnimationFrame;++d)window.requestAnimationFrame=window[c[d]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[c[d]+"CancelAnimationFrame"]||window[c[d]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(a,c){var d=(new Date).getTime(),e=Math.max(0,16-(d-b)),f=window.setTimeout(function(){a(d+e)},e);return b=d+e,f}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)}),a&&window.cancelAnimationFrame(a)}D();var b,c,d,e,f,g,h=!0,i=[],j=$("#reactive-bg-canvas"),k={lineLen:30,heartBeatCD:3e3,heartBeatRange:300,rgb:{r:156,g:217,b:249},type:"heart-beat",zIndex:-99999},l=$.extend(k,a);$(document).mouseenter(function(){h=!0}),$(document).mouseleave(function(){h=!1}),m(),r(),n()}};