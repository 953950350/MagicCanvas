jQuery.magicCanvas={draw:function(a){function b(){q=document.getElementById("reactive-bg-canvas"),o=$(window).width(),p=$(window).height(),q.style.position="fixed",q.style.zIndex=-99999,q.style.top="0px",q.style.left="0px",q.width=o,q.height=p,t={x:o/2,y:p/2},r=q.getContext("2d"),n()}function c(){"ontouchstart"in window||window.addEventListener("mousemove",d),window.addEventListener("resize",e)}function d(a){t.x=a.pageX,t.y=a.pageY}function e(){o=window.innerWidth,p=window.innerHeight,q.width=o,q.height=p}function f(){g(),setInterval(h,x.heartBeatCD)}function g(){r.clearRect(0,0,o,p);for(var a=0;a<v.length;a++){var b=v[a];b.circle.active>0&&(b.circle.active-=.012,b.circle.draw())}requestAnimationFrame(g)}function h(){var a=i(),b=new l(a,0),c=.8*x.heartBeatCD,d=60*c/1e3,e=x.heartBeatRange/d,f=c/d,g=.8,h={x:t.x,y:t.y};v=[];var j=function(){if(b.radius<x.heartBeatRange){for(var a=0;a<s.length;a++){var c=s[a];if(m(c,b.pos)<Math.pow(b.radius,2))for(var d=0;d<c.closest.length;d++){var i=c.closest[d],n=k(c,i,b);void 0!=n&&(n.circle=new l(n,1.2,h),n.circle.active=g,g*=.999,v.push(n))}}setTimeout(j,f),b.radius+=e}};u&&j()}function i(){for(var a={x:-100,y:-100},b=0;b<s.length;b++){var c=s[b];a=m(t,c)<m(t,a)?c:a}return a}function j(a,b){var c=x.lineLen*Math.sin(60*Math.PI/180),d=x.lineLen*Math.cos(60*Math.PI/180),e={closest:[]};return"left"==b||"right"==b?(e.x=a.x+x.lineLen*("left"==b?-1:1),e.y=a.y):"rightTop"==b||"rightBottom"==b?(e.x=a.x+d,e.y=a.y+c*("rightTop"==b?-1:1)):("leftTop"==b||"leftBottom"==b)&&(e.x=a.x-d,e.y=a.y+c*("leftTop"==b?-1:1)),e.type=b,a.closest.push(e),e.closest.push(a),e}function k(a,b,c){var d=m(a,c.pos),e=m(b,c.pos),f=Math.sqrt(Math.max(d,e)),g=Math.sqrt(Math.min(d,e));if(g<c.radius&&f>c.radius){var h=(a.y-b.y)/(a.x-b.x),i=a.y-h*a.x,j=-c.pos.x,k=-c.pos.y,l=c.radius,n=(Math.pow(h,2)+1)*Math.pow(l,2)-Math.pow(j*h,2)+2*(j*k+i*j)*h-Math.pow(k+i,2),o=(-1*Math.sqrt(n)-h*(k+i)-j)/(Math.pow(h,2)+1),p=(Math.sqrt(n)-h*(k+i)-j)/(Math.pow(h,2)+1),q=o<Math.max(a.x,b.x)&&o>Math.min(a.x,b.x)?o:p,r=h*q+i;return{x:q,y:r}}}function l(a,b,c){this.pos=a||null,this.radius=b||null,this.centerP=c||a,this.draw=function(){if(this.active){r.beginPath(),r.arc(this.pos.x,this.pos.y,this.radius,0,2*Math.PI,!1);var b="function"==typeof x.rgb?x.rgb(a,c):x.rgb;b="".concat(b.r).concat(",").concat(b.g).concat(",").concat(b.b),r.fillStyle="rgba("+b+","+this.active+")",r.fill()}}}function m(a,b){return Math.pow(a.x-b.x,2)+Math.pow(a.y-b.y,2)}function n(){var a={x:o/2,y:p/2,closest:[]},b=[j(a,"left"),j(a,"rightTop"),j(a,"rightBottom")];for(s=[a];b.length>0;){var c=b.pop();if(0<c.x&&c.x<o&&0<c.y&&c.y<p){for(var d=!1,e=0;e<s.length;e++){var f=s[e],g=m(c,f);if(g<.1*Math.pow(x.lineLen,2)){d=!0;break}}if(!d){s.push(c);var h=c.type;"leftTop"==h||"leftBottom"==h?(b.unshift(j(c,"left")),b.unshift(j(c,"leftTop"==h?"rightTop":"rightBottom"))):"rightTop"==h||"rightBottom"==h?(b.unshift(j(c,"right")),b.unshift(j(c,"rightTop"==h?"leftTop":"leftBottom"))):"left"==h?(b.unshift(j(c,"leftBottom")),b.unshift(j(c,"leftTop"))):"right"==h&&(b.unshift(j(c,"rightBottom")),b.unshift(j(c,"rightTop")))}}}for(var e=0;e<s.length;e++)s[e].circle=new l(s[e],2)}var o,p,q,r,s,t,u=!0,v=[],w={lineLen:30,heartBeatCD:3e3,heartBeatRange:300,rgb:{r:156,g:217,b:249}},x=$.extend(w,a);$(document).mouseenter(function(){u=!0}),$(document).mouseleave(function(){u=!1}),b(),f(),c()}};